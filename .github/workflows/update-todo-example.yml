name: update-todo-example
on:
  schedule:
    # 毎日 JST 9:00 (UTC 0:00) に実行
    - cron: "0 0 * * *"
  workflow_dispatch:
jobs:
  update-subtree:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - uses: actions/checkout@v5
        with:
          fetch-depth: 0
      - name: Configure Git
        run: |
          git config user.name github-actions[bot]
          git config user.email github-actions[bot]@users.noreply.github.com
      - name: Update subtree
        run: |
          git subtree add --prefix=examples/todo https://github.com/kou029w/todo-example.git main --squash -m add || \
          git subtree pull --prefix=examples/todo https://github.com/kou029w/todo-example.git main --squash -m update
      - name: Check for changes and push
        run: |
          if git log --oneline origin/main..@ | read; then
            git push origin main
          fi
